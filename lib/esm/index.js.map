{"version":3,"sources":["../../src/index.ts"],"names":["chalk","path","loadConfig","Alation","runTermService","runPhysicService","inquirer","run","console","log","bgBlack","white","inputConfigPath","inputFilePath","inputMode","inputSkipHeader","prompt","type","name","message","bgGray","green","default","join","process","cwd","choices","filter","input","configPath","isAbsolute","filePath","config","env","connector","username","password","host","tokenName","tokenStoragePath","e","error"],"mappings":"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","sourcesContent":["import chalk from 'chalk';\nimport path from 'path';\nimport {loadConfig} from './helpers/config';\nimport {Alation} from 'alation_connector';\nimport {runTermService} from './services/term';\nimport {runPhysicService} from './services/physics';\nimport {ModeType, TerminalAnswer} from './types';\nimport inquirer from 'inquirer';\n\nexport async function run(): Promise<void> {\n  try {\n    console.log(chalk.bgBlack(chalk.white('Загрузчик терминов и физики в Alation')));\n    const {\n      inputConfigPath,\n      inputFilePath,\n      inputMode,\n      inputSkipHeader,\n    } = await inquirer.prompt<TerminalAnswer>([\n      {\n        type: 'input',\n        name: 'inputConfigPath',\n        message: chalk.bgGray(chalk.green('Укажите путь к конфигурационному файлу')),\n        default: path.join(process.cwd(), 'config.json'),\n      },\n      {\n        type: 'list',\n        name: 'inputMode',\n        message: chalk.bgGray(chalk.green('Выберите режим работы')),\n        choices: [\n          'Загрузка терминов',\n          'Загрузка физики',\n        ],\n        default: 'Загрузка физики',\n        filter(input: string): ModeType {\n          if (input === 'Загрузка терминов') {\n            return 'terms';\n          }\n          return 'physics';\n        },\n      },\n      {\n        type: 'input',\n        name: 'inputFilePath',\n        message: chalk.bgGray(chalk.green('Укажите путь к TSV файлу')),\n        default: path.join(process.cwd(), 'uploads/physics.tsv'),\n      },\n      {\n        type: 'list',\n        name: 'inputSkipHeader',\n        message: chalk.bgGray(chalk.green('Первая запись в файле заголовок?')),\n        choices: [\n          'Да',\n          'Нет',\n        ],\n        default: 'Да',\n        filter(input: string): boolean {\n          return input === 'Да';\n        },\n      },\n    ]);\n\n    const configPath: string = path.isAbsolute(inputConfigPath) ? inputConfigPath : path.join(process.cwd(), inputConfigPath);\n    const filePath: string = path.isAbsolute(inputFilePath) ? inputFilePath : path.join(process.cwd(), inputFilePath);\n    const config = loadConfig(configPath);\n\n\n    process.env['NODE_TLS_REJECT_UNAUTHORIZED'] = '0';\n    const connector = new Alation({\n      username: config.username,\n      password: config.password,\n    }, config.host, {tokenName: config.tokenName, tokenStoragePath: config.tokenStoragePath});\n\n\n    if (inputMode === 'terms') {\n      await runTermService(connector, config, filePath, inputSkipHeader);\n    } else {\n      await runPhysicService(connector, config, filePath, inputSkipHeader);\n    }\n  } catch (e) {\n    console.error(e.message);\n  }\n  console.log('Завершение работы');\n}\n"],"file":"index.js"}