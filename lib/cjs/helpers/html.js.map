{"version":3,"sources":["../../../src/helpers/html.ts"],"names":["generateEntityLink","otype","entity","HTMLElement","class","id","url","generateTextElement","content","tag","set_content","generateLineageTableRow","entityType","ds","schema","table","attribute","row","descriptionTag","datasourceTag","schemaTag","tableTag","attributeTag","linkTag","appendChild","title","name","description","generateLink","parent","link","generateLineageTable","root","head","body","insertOrReplaceTableRow","querySelector","findRow","getAttribute","removeChild"],"mappings":"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","sourcesContent":["import {HTMLElement} from 'node-html-parser';\nimport {IAlationEntity, IAttribute, IDatasource, ISchema, ITable, ObjectType} from 'alation_connector';\nimport {Assign} from 'utility-types';\n\n\nexport function generateEntityLink(otype: ObjectType, entity: Assign<IAlationEntity, { url: string }>): HTMLElement {\n  return new HTMLElement('a',\n      {class: 'term_loader_link'},\n      `data-oid=\"${entity.id}\" data-otype=\"${otype}\" href=\"${entity.url}\"`, null);\n}\n\nexport function generateTextElement(content: string): HTMLElement {\n  const tag = new HTMLElement('p', {class: 'term_loader_text'}, '', null);\n  tag.set_content(content);\n  return tag;\n}\n\nexport function generateLineageTableRow(entityType: 'table', ds: IDatasource, schema: ISchema, table: ITable): HTMLElement;\nexport function generateLineageTableRow(entityType: 'attribute',\n                                        ds: IDatasource,\n                                        schema: ISchema,\n                                        table: ITable,\n                                        attribute: IAttribute): HTMLElement;\nexport function generateLineageTableRow(entityType: 'attribute' | 'table',\n    ds: IDatasource,\n    schema: ISchema,\n    table: ITable,\n    attribute?: IAttribute): HTMLElement {\n  const row = new HTMLElement(\n      'tr',\n      {\n        class: 'term_loader_table_row',\n        id: `term_lineage_row_${entityType}_${(entityType === 'attribute' && attribute) ? attribute.id : table.id}`,\n      },\n      ``, null);\n\n  const descriptionTag = new HTMLElement('td', {}, '', row);\n  const datasourceTag = new HTMLElement('td', {}, '', row);\n  const schemaTag = new HTMLElement('td', {}, '', row);\n  const tableTag = new HTMLElement('td', {}, '', row);\n  const attributeTag = new HTMLElement('td', {}, '', row);\n  const linkTag = new HTMLElement('td', {}, '', row);\n\n  row.appendChild(descriptionTag);\n  row.appendChild(datasourceTag);\n  row.appendChild(schemaTag);\n  row.appendChild(tableTag);\n  row.appendChild(attributeTag);\n  row.appendChild(linkTag);\n\n  datasourceTag.appendChild(generateTextElement(ds.title));\n  schemaTag.appendChild(generateTextElement(schema.name));\n  tableTag.appendChild(generateTextElement(table.name));\n\n\n  if (entityType === 'attribute' && attribute) {\n    attributeTag.appendChild(generateTextElement(attribute.name));\n    descriptionTag.appendChild(generateTextElement(attribute.description));\n    linkTag.appendChild(generateLink(attribute.url, linkTag));\n  } else {\n    descriptionTag.appendChild(generateTextElement(table.description));\n    linkTag.appendChild(generateLink(table.url, linkTag));\n  }\n\n  return row;\n}\n\n\nexport function generateLink(url: string, parent: HTMLElement | null = null, name = 'Ссылка'): HTMLElement {\n  const link = new HTMLElement('a', {}, `href=\"${url}\"`, parent);\n  link.set_content(name);\n  return link;\n}\n\nexport function generateLineageTable(): HTMLElement {\n  const root = new HTMLElement('table',\n      {class: 'term_loader_table'},\n      'style=\"width: 100%;\"', null);\n  const head = new HTMLElement('thead',\n      {class: 'term_loader_table', id: 'term_loader_lineage_table_header'},\n      '', root);\n\n  head.appendChild(new HTMLElement('tr', {\n    class: 'term_loader_table',\n    id: 'term_loader_lineage_table_header',\n  }, '', head));\n\n  const descriptionTag = new HTMLElement('th', {}, '', head);\n  const datasourceTag = new HTMLElement('th', {}, '', head);\n  const schemaTag = new HTMLElement('th', {}, '', head);\n  const tableTag = new HTMLElement('th', {}, '', head);\n  const attributeTag = new HTMLElement('th', {}, '', head);\n  const linkTag = new HTMLElement('th', {}, '', head);\n\n  head.appendChild(descriptionTag);\n  head.appendChild(datasourceTag);\n  head.appendChild(schemaTag);\n  head.appendChild(tableTag);\n  head.appendChild(attributeTag);\n  head.appendChild(linkTag);\n\n  descriptionTag.set_content('Описание');\n  datasourceTag.set_content('Система');\n  schemaTag.set_content('Схема');\n  tableTag.set_content('Таблица');\n  attributeTag.set_content('Аттрибут');\n  linkTag.set_content('Ссылка');\n\n  const body = new HTMLElement('tbody', {class: 'term_loader_table', id: 'term_loader_lineage_table_body'}, '', root);\n  root.appendChild(head);\n  root.appendChild(body);\n\n  return root;\n}\n\nexport function insertOrReplaceTableRow(table: HTMLElement, row: HTMLElement): HTMLElement {\n  const tableTag = table.querySelector('table') ?? generateLineageTable();\n  const body = tableTag.querySelector('tbody') as HTMLElement;\n  const findRow = body.querySelector(\n      // eslint-disable-next-line max-len\n      `tr#${row.getAttribute('id')}`,\n  );\n\n  if (findRow) {\n    body.removeChild(findRow);\n  }\n\n  body.appendChild(row);\n\n  return tableTag;\n}\n"],"file":"html.js"}