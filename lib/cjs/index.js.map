{"version":3,"sources":["../../src/index.ts"],"names":["run","process","env","console","log","inputConfigPath","inputFilePath","inputMode","inputSkipHeader","inquirer","prompt","type","name","message","default","path","join","cwd","choices","filter","input","configPath","isAbsolute","filePath","config","connector","Alation","username","password","host","tokenName","tokenStoragePath","e","error"],"mappings":"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","sourcesContent":["import path from 'path';\nimport {loadConfig} from './helpers/config';\nimport {Alation} from 'alation_connector';\nimport {runTermService} from './services/term';\nimport {runPhysicService} from './services/physics';\nimport {ModeType, TerminalAnswer} from './types';\nimport inquirer from 'inquirer';\n\nexport async function run(): Promise<void> {\n  try {\n    process.env['NODE_TLS_REJECT_UNAUTHORIZED'] = '0';\n    console.log('Загрузчик терминов и физики в Alation');\n    const {\n      inputConfigPath,\n      inputFilePath,\n      inputMode,\n      inputSkipHeader,\n    } = await inquirer.prompt<TerminalAnswer>([\n      {\n        type: 'input',\n        name: 'inputConfigPath',\n        message: 'Укажите путь к конфигурационному файлу',\n        default: path.join(process.cwd(), 'config.json'),\n      },\n      {\n        type: 'list',\n        name: 'inputMode',\n        message: 'Выберите режим работы',\n        choices: [\n          'Загрузка терминов',\n          'Загрузка физики',\n        ],\n        default: 'Загрузка терминов',\n        filter(input: string): ModeType {\n          if (input === 'Загрузка терминов') {\n            return 'terms';\n          }\n          return 'physics';\n        },\n      },\n      {\n        type: 'input',\n        name: 'inputFilePath',\n        message: 'Укажите путь к TSV файлу',\n        default: path.join(process.cwd(), 'file.tsv'),\n      },\n      {\n        type: 'list',\n        name: 'inputSkipHeader',\n        message: 'Первая запись в файле заголовок?',\n        choices: [\n          'Да',\n          'Нет',\n        ],\n        default: 'Да',\n        filter(input: string): boolean {\n          return input === 'Да';\n        },\n      },\n    ]);\n\n    const configPath: string = path.isAbsolute(inputConfigPath) ? inputConfigPath : path.join(process.cwd(), inputConfigPath);\n    const filePath: string = path.isAbsolute(inputFilePath) ? inputFilePath : path.join(process.cwd(), inputFilePath);\n    const config = loadConfig(configPath);\n\n\n    const connector = new Alation({\n      username: config.username,\n      password: config.password,\n    }, config.host, {tokenName: config.tokenName, tokenStoragePath: config.tokenStoragePath});\n\n\n    if (inputMode === 'terms') {\n      await runTermService(connector, config, filePath, inputSkipHeader);\n    } else {\n      await runPhysicService(connector, config, filePath, inputSkipHeader);\n    }\n  } catch (e) {\n    console.error(e.message);\n  }\n  console.log('Завершение работы');\n}\n"],"file":"index.js"}